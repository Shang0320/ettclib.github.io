<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>海巡署圖書查詢系統</title>

  <!-- Bootstrap CSS & JS -->
  <link rel="stylesheet" href="/assets/bootstrap.min.css">
  <script defer src="/assets/bootstrap.bundle.min.js"></script>

  <!-- Font Awesome 圖示庫 -->
  <script src="papaparse.min.js"></script>
  <style>
    @font-face {
      font-family: 'CustomIcons';
      src: url('data:application/font-woff;charset=utf-8;base64,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') format('woff');
    }

    [class^="icon-"], [class*=" icon-"] {
      font-family: 'CustomIcons' !important;
      speak: never;
      font-style: normal;
      font-weight: normal;
      font-variant: normal;
      text-transform: none;
      line-height: 1;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .icon-book:before { content: "\e900"; }
    .icon-search:before { content: "\e901"; }
    .icon-user:before { content: "\e902"; }
    .icon-users:before { content: "\e903"; }
    .icon-newspaper:before { content: "\e904"; }
    .icon-graduation-cap:before { content: "\e905"; }
    .icon-calendar:before { content: "\e906"; }
    .icon-check:before { content: "\e907"; }
    .icon-pencil:before { content: "\e908"; }
    .icon-building:before { content: "\e909"; }
    .icon-tag:before { content: "\e90a"; }
    .icon-heart:before { content: "\e90b"; }
    .icon-cancel:before { content: "\e90c"; }
  </style>


  <!-- 客製化 CSS -->
  <style>
    :root {
      --primary-color: #1a56db;
      --secondary-color: #0694a2;
      --accent-color: #3f83f8;
      --light-color: #f9fafb;
      --dark-color: #111827;
      --gradient-start: #1e40af;
      --gradient-end: #0369a1;
    }
    
    body {
      background-color: #f0f4f8;
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    
    /* 自訂動畫 */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.6s ease forwards;
    }
    
    /* 頂部橫幅 */
    .banner {
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      color: white;
      position: relative;
      overflow: hidden; /* 允許內容溢出 */
      animation: bannerIn 1s both;
      animation-timing-function: ease;
    }
    
    @keyframes bannerIn {
      from { opacity: 0; transform: translateY(-60px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .banner::before {
      content: "";
      position: absolute;
      top: -20%;
      left: -40%;
      width: 150%;
      height: 120%;
      background: radial-gradient(circle at 15% 50%, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 80%);
      animation: rotate 14s linear infinite;
      z-index: 5; /* 確保旋轉效果在內容上方 */
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .banner-content {
      position: relative;
      z-index: 10;
    }
    
    /* 導航標籤 */
    .nav-pills .nav-link {
      border-radius: 30px;
      padding: 0.6rem 1.5rem;
      transition: all 0.3s ease;
      margin: 0 0.25rem;
      color: var(--dark-color);
      font-weight: 500;
    }
    
    .nav-pills .nav-link:not(.active):hover {
      background-color: rgba(63, 131, 248, 0.1);
      transform: translateY(-2px);
    }
    
    .nav-pills .nav-link.active {
      background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
      box-shadow: 0 4px 15px rgba(26, 86, 219, 0.3);
      transform: translateY(-2px);
    }
    
    /* 卡片樣式 */
    .card {
      border: none;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
    }
    
    .card:hover {
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
      transform: translateY(-3px);
    }
    
    /* 表格美化 */
    .table {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      background: #b8f2e6; /* 馬卡龍綠色 */
    }
    
    thead tr {
      background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
      color: white;
    }
    
    .table > :not(caption) > * > * {
      padding: 1rem 0.75rem;
      vertical-align: middle;
    }
    
    tbody tr {
      transition: all 0.2s ease;
    }
    
    tbody tr:nth-of-type(odd) {
      background-color: rgba(249, 250, 251, 0.8);
    }
    
    tbody tr:hover {
      background-color: rgba(224, 242, 254, 0.8);
      transform: translateX(3px);
    }
    
    /* 按鈕樣式 */
    .btn {
      border-radius: 30px;
      font-weight: 500;
      padding: 0.5rem 1.5rem;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      border: none;
      box-shadow: 0 4px 10px rgba(63, 131, 248, 0.25);
    }
    
    .btn-primary:hover {
      box-shadow: 0 6px 15px rgba(63, 131, 248, 0.35);
      transform: translateY(-2px);
    }
    
    .btn-success {
      background: linear-gradient(90deg, #059669, #34d399);
      border: none;
      box-shadow: 0 4px 10px rgba(5, 150, 105, 0.25);
    }
    
    .btn-success:hover {
      box-shadow: 0 6px 15px rgba(5, 150, 105, 0.35);
      transform: translateY(-2px);
    }
    
    .btn-danger {
      background: linear-gradient(90deg, #dc2626, #f87171);
      border: none;
      box-shadow: 0 4px 10px rgba(220, 38, 38, 0.25);
    }
    
    .btn-danger:hover {
      box-shadow: 0 6px 15px rgba(220, 38, 38, 0.35);
      transform: translateY(-2px);
    }
    
    /* 輸入框樣式 */
    .form-control {
      border-radius: 30px;
      padding: 0.6rem 1.2rem;
      border: 1px solid #e5e7eb;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      border-color: var(--accent-color);
      box-shadow: 0 2px 12px rgba(63, 131, 248, 0.15);
    }
    
    /* 彈出框美化 */
    .modal-content {
      border: none;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }
    
    .modal-header {
      background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
      color: white;
      border-top-left-radius: 15px;
      border-top-right-radius: 15px;
      border-bottom: none;
    }
    
    .modal-footer {
      border-top: none;
    }
    
    /* 標籤文字美化 */
    label {
      font-weight: 500;
      color: #4b5563;
    }
    
    /* 響應式調整 */
    @media (max-width: 768px) {
      .nav-pills .nav-link {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
      }
      
      .table-responsive {
        box-shadow: none;
      }
      
      .table {
        box-shadow: none;
      }
    }
    
    /* 自訂搜尋區塊美化 */
    .search-container {
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      padding: 1.5rem;
      margin-bottom: 2rem;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }
    
    .search-container:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }
    
    .search-container::before {
      content: '';
      position: absolute;
      top: -50%; right: -50%;
      width: 150%; height: 150%;
      background: radial-gradient(circle at 30% 30%, rgba(63, 131, 248, 0.08) 0%, rgba(63, 131, 248, 0) 60%);
      animation: searchFloat 12s ease-in-out infinite alternate;
      z-index: 0;
    }
    
    @keyframes searchFloat {
      0% { transform: translateY(0) translateX(0); }
      100% { transform: translateY(-30px) translateX(30px); }
    }
    
    .search-title {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      position: relative;
      z-index: 1;
    }
    
    .search-title i {
      margin-right: 0.5rem;
    }
    
    /* 統計數字展示 */
    .stats-container {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .stat-card {
      flex: 1;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      padding: 1.2rem;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }
    
    .stat-card:hover {
      transform: translateY(-8px) scale(1.05);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
    }
    
    /* 多個小氣泡動畫 */
    .bubbles {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }
    .bubble {
      position: absolute;
      border-radius: 50%;
      opacity: 0.35;
      background: radial-gradient(circle at 60% 40%, #bcdcff 0%, #e3f0ff 100%);
      animation: bubble-move 12s linear infinite;
    }
    @keyframes bubble-move {
      0% {
        transform: translateY(100%) scale(0.7);
        opacity: 0.18;
      }
      20% {
        opacity: 0.35;
      }
      80% {
        opacity: 0.35;
      }
      100% {
        transform: translateY(-120%) scale(1.1);
        opacity: 0.18;
      }
    }
    
    .stat-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      position: relative;
      z-index: 1;
    }
    
    .stat-number {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--dark-color);
      position: relative;
      z-index: 1;
    }
    
    .stat-label {
      font-size: 0.9rem;
      color: #6b7280;
      position: relative;
      z-index: 1;
    }
    
    /* 表格標題行特效 */
    .table th {
      position: sticky;
      top: 0;
      background: #E1FFF2 !important;
      z-index: 2;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    
    .table td {
      background: #fff !important;
    }
    
    .table thead th::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: rgba(255, 255, 255, 0.3);
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
    
    .table thead th:hover::after {
      transform: translateX(0);
    }

    /* 表格懸停效果 */
    .table-responsive {
      border-radius: 12px;
      overflow: hidden;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
    }

    .table-responsive:hover {
      transform: translateY(-5px) scale(1.01);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
    }

    /* 表格行效果調整 */
    tbody tr {
      transition: all 0.3s ease;
    }

    tbody tr:hover {
      background-color: rgba(224, 242, 254, 0.8);
      transform: translateX(5px) scale(1.01);
      box-shadow: -5px 0 15px rgba(0, 0, 0, 0.05);
    }

    /* 表格奇數行背景調整 */
    tbody tr:nth-of-type(odd) {
      background-color: rgba(249, 250, 251, 0.8);
    }

    /* 表格布局優化 */
    .table {
      table-layout: fixed;
      width: 100%;
      border-collapse: collapse;
    }

    /* 進一步優化表格欄位顯示 */
    .table th,
    .table td {
      text-align: center;
      vertical-align: middle;
      padding: 0.75rem 0.5rem;
    }

    /* 表格最終優化 */
    .table thead th,
    .table tbody td {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* 借出項目強調 */
    .borrowed-item {
      position: relative;
      transition: all 0.3s ease;
    }

    .borrowed-item:hover {
      z-index: 10;
    }

    .borrowed-recently {
      position: relative;
      overflow: hidden;
    }

    .borrowed-recently::after {
      content: '近期借出';
      position: absolute;
      top: 8px;
      right: -30px;
      background: var(--accent-color);
      color: white;
      font-size: 0.7rem;
      padding: 2px 30px;
      transform: rotate(45deg);
      z-index: 5;
    }

    /* 針對書名等長文本欄位特殊處理 */
    .table td.book-title {
      white-space: normal;
      max-width: 200px;
      word-break: break-word;
    }

    /* 優化借閱按鈕 */
    .borrow-button {
      width: 80px;
    }

    /* 表格中的 colgroup 強制固定寬度 */
    #book .table colgroup col {
      width: var(--col-width) !important;
    }

    /* 頁面載入進度條 */
    #page-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      z-index: 9999;
      display: none;
    }

    #page-loader .loader-bar {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
      background-size: 200% 100%;
      animation: load-progress 3s ease forwards;
    }

    @keyframes load-progress {
      0% { width: 0; }
      10% { width: 15%; }
      30% { width: 40%; }
      50% { width: 65%; }
      80% { width: 85%; }
      100% { width: 100%; }
    }

    /* 圖片淡入縮放效果 */
    .image-zoom {
      opacity: 0;
      transform: scale(0.9);
      animation: fadeInZoom 1.2s ease forwards;
    }

    @keyframes fadeInZoom {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    /* 延遲加載序列 */
    .zoom-delay-1 { animation-delay: 0.2s; }
    .zoom-delay-2 { animation-delay: 0.4s; }
    .zoom-delay-3 { animation-delay: 0.6s; }

    /* 平滑滾動顯示效果 */
    .scroll-animate {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    .scroll-animate.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .banner img {
      height: 90px;
      margin-right: 36px;
      filter: drop-shadow(0 0 16px #fff8);
      animation: logoPop 1.2s;
    }
    @keyframes logoPop {
      0% { transform: scale(0.5);}
      80% { transform: scale(1.1);}
      100% { transform: scale(1);}
    }

    @media (max-width: 430px) {
      .banner img {
        height: 48px;
        margin-right: 12px;
      }
      .banner-content h1 {
        font-size: 1.1rem;
      }
      .banner-content p {
        font-size: 0.85rem;
      }
      .stats-container {
        flex-direction: column;
        gap: 0.5rem;
      }
      .stat-card {
        padding: 0.7rem 0.5rem;
        font-size: 0.95rem;
      }
      .stat-icon {
        font-size: 1.3rem;
      }
      .stat-number {
        font-size: 1.2rem;
      }
      .search-container {
        padding: 0.7rem 0.5rem;
        margin-bottom: 1rem;
      }
      .search-title {
        font-size: 1rem;
      }
      .form-label {
        font-size: 0.95rem;
      }
      .form-control {
        font-size: 0.95rem;
        padding: 0.4rem 0.7rem;
      }
      .input-group-text {
        font-size: 1rem;
        padding: 0.3rem 0.5rem;
      }
      .table-responsive {
        font-size: 0.92rem;
        padding: 0;
        margin-bottom: 0.7rem;
        overflow-x: auto;
      }
      .table th, .table td {
        padding: 0.45rem 0.2rem;
        font-size: 0.92rem;
      }
      .pagination {
        font-size: 1rem;
      }
      .page-link {
        padding: 0.35rem 0.7rem;
      }
      .nav-pills .nav-link {
        padding: 0.4rem 0.7rem;
        font-size: 0.95rem;
      }
    }
  </style>
</head>
<body>
  <div id="page-loader">
    <div class="loader-bar"></div>
  </div>

  <!-- Banner -->
  <header class="banner py-4 d-flex align-items-center px-4 mb-4">
    <div class="banner-content d-flex align-items-center w-100">
      <img src="logo.png" alt="logo">
      <div>
        <h1 class="h4 mb-1 fw-bold image-zoom zoom-delay-1">海巡署教育訓練測考中心圖書查詢系統</h1>
        <p class="mb-0 opacity-75 image-zoom zoom-delay-2">Coast Guard Administration Education and Training Testing Center Library Query System</p>
      </div>
    </div>
  </header>

  <div class="container-fluid px-4">
    <!-- 數據統計展示 -->
    <div class="stats-container fade-in scroll-animate">
      <div class="stat-card" onclick="switchTab('thesis', document.querySelector('.nav-link[onclick*=\'thesis\']'))" style="cursor: pointer;">
        <div class="stat-icon"><i class="fas fa-scroll"></i></div>
        <div class="stat-number" id="thesis-count">0</div>
        <div class="stat-label">論文總數</div>
      </div>   
      <div class="stat-card" onclick="switchTab('journal', document.querySelector('.nav-link[onclick*=\'journal\']'))" style="cursor: pointer;">
        <div class="stat-icon"><i class="fas fa-newspaper"></i></div>
        <div class="stat-number" id="journal-count">0</div>
        <div class="stat-label">期刊總數</div>
      </div>
      <div class="stat-card" onclick="switchTab('book', document.querySelector('.nav-link[onclick*=\'book\']'))" style="cursor: pointer;">
        <div class="stat-icon"><i class="fas fa-book-open"></i></div>
        <div class="stat-number" id="book-count">0</div>
        <div class="stat-label">書籍總數</div>
      </div>
    </div>

    <!-- Tabs -->
    <nav class="my-4">
      <ul class="nav nav-pills justify-content-center mb-4">
        <li class="nav-item"><button class="nav-link active" onclick="switchTab('thesis', this)"><i class="fas fa-graduation-cap me-2"></i>論文查詢</button></li>
        <li class="nav-item"><button class="nav-link" onclick="switchTab('journal', this)"><i class="fas fa-newspaper me-2"></i>期刊查詢</button></li>
        <li class="nav-item"><button class="nav-link" onclick="switchTab('book', this)"><i class="fas fa-book me-2"></i>書籍查詢</button></li>
      </ul>
    </nav>

    <!-- 論文 查詢 -->
    <section id="thesis" class="tab-content fade-in scroll-animate">
      <div class="search-container mb-4">
        <h5 class="search-title"><i class="fas fa-search"></i> 論文資料檢索</h5>
        <div class="row align-items-end g-3">
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-bookmark me-1"></i> 論文標題</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-book-open text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入關鍵字..." data-key="論文名稱">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-user-graduate me-1"></i> 研究生</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-user text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入姓名..." data-key="研究生">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-chalkboard-teacher me-1"></i> 指導教授</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-user-tie text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入姓名..." data-key="指導教授">
            </div>
          </div>
        </div>
      </div>
      <div id="thesis-card-list" class="row g-3 mb-5" style="display:none;"></div>
      <div class="table-responsive mb-5" id="thesis-table-area">
        <table class="table table-bordered table-hover text-center">
          <colgroup>
            <col style="width:4%"><!-- 序號 -->
            <col style="width:22%"><!-- 論文名稱 -->
            <col style="width:10%"><!-- 研究生 -->
            <col style="width:12%"><!-- 指導教授 -->
            <col style="width:14%"><!-- 校院名稱 -->
            <col style="width:14%"><!-- 系所名稱 -->
            <col style="width:8%"><!-- 學位類別 -->
            <col style="width:8%"><!-- 畢業學年度 -->
            <col style="width:8%"><!-- 論文出版年 -->
          </colgroup>
          <thead>
            <tr>
              <th>序號</th><th>論文名稱</th><th>研究生</th><th>指導教授</th><th>校院名稱</th>
              <th>系所名稱</th><th>學位類別</th><th>畢業學年度</th><th>論文出版年</th>
            </tr>
          </thead>
          <tbody id="thesis-body"></tbody>
        </table>
      </div>
      <nav class="d-flex justify-content-center"><ul class="pagination" id="thesis-pagination"></ul></nav>
    </section>

    <!-- 期刊 查詢 -->
    <section id="journal" class="tab-content d-none fade-in scroll-animate">
      <div class="search-container mb-4">
        <h5 class="search-title"><i class="fas fa-search"></i> 期刊資料檢索</h5>
        <div class="row align-items-end g-3">
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-newspaper me-1"></i> 刊名</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-file-alt text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入刊名..." data-key="刊名">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-hashtag me-1"></i> 期數</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-sort-numeric-up text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入期數..." data-key="期數">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-building me-1"></i> 出版者</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-print text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入出版單位..." data-key="出版者">
            </div>
          </div>
        </div>
      </div>
      <div id="journal-card-list" class="row g-3 mb-5" style="display:none;"></div>
      <div class="table-responsive mb-5" id="journal-table-area">
        <table class="table table-bordered table-hover text-center">
          <thead>
            <tr>
              <th>序號</th><th>刊名</th><th>出版者</th><th>作者</th><th>期數</th>
              <th>期刊分類</th><th>藏書位置</th>
            </tr>
          </thead>
          <tbody id="journal-body"></tbody>
        </table>
      </div>
      <nav class="d-flex justify-content-center"><ul class="pagination" id="journal-pagination"></ul></nav>
    </section>

    <!-- 書籍 查詢 -->
    <section id="book" class="tab-content d-none fade-in scroll-animate">
      <div class="search-container mb-4">
        <h5 class="search-title"><i class="fas fa-search"></i> 書籍資料檢索</h5>
        <div class="row align-items-end g-3">
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-book me-1"></i> 書名</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-book-open text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入書名..." data-key="書名">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-pen-fancy me-1"></i> 作者</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-user-edit text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入作者..." data-key="作者">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <label class="form-label fw-medium"><i class="fas fa-tags me-1"></i> 分類</label>
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="fas fa-folder text-primary"></i></span>
              <input class="form-control filter" placeholder="請輸入分類..." data-key="分類">
            </div>
          </div>
        </div>
      </div>
      <div id="book-card-list" class="row g-3 mb-5" style="display:none;"></div>
      <div class="table-responsive mb-5" id="book-table-area">
        <table class="table table-bordered table-hover text-center">
          <colgroup>
            <col style="--col-width:4%"><!-- 序號 -->
            <col style="--col-width:18%"><!-- 書名 -->
            <col style="--col-width:10%"><!-- 作者 -->
            <col style="--col-width:10%"><!-- 出版者 -->
            <col style="--col-width:6%"><!-- 出版年 -->
            <col style="--col-width:9%"><!-- 分類 -->
            <col style="--col-width:9%"><!-- 索書號 -->
            <col style="--col-width:8%"><!-- 藏書位置 -->
            <col style="--col-width:5%"><!-- 數量 -->
          </colgroup>
          <thead>
            <tr>
              <th>序號</th><th>書名</th><th>作者</th><th>出版者</th><th>出版年</th>
              <th>分類</th><th>索書號</th><th>藏書位置</th><th>數量</th>
            </tr>
          </thead>
          <tbody id="book-body"></tbody>
        </table>
      </div>
      <nav class="d-flex justify-content-center"><ul class="pagination" id="book-pagination"></ul></nav>
    </section>
  </div>

  <!-- Footer -->
  <footer class="bg-white py-4 mt-5 text-center text-muted fade-in">
    <p class="mb-0">&copy; 2025 海巡署教育訓練測考中心 | 圖書查詢系統 v2.0</p>
  </footer>

  <!-- Scripts -->
   <!-- 本機 JS 資源 -->
  <script src="./assets/bootstrap.bundle.min.js"></script>
  <script>
    const dataStore={ thesis:[], journal:[], book:[] };
    async function fetchData(type) {
      let action = '';
      if(type==='thesis') action='get_thesis';
      if(type==='journal') action='get_journals';
      if(type==='book') action='get_books';
      const res = await fetch(`api.php?action=${action}`);
      return await res.json();
    }
    async function updateStats() {
      dataStore.thesis = await fetchData('thesis');
      dataStore.journal = await fetchData('journal');
      dataStore.book = await fetchData('book');
      document.getElementById('thesis-count').textContent = dataStore.thesis.length;
      document.getElementById('journal-count').textContent = dataStore.journal.length;
      document.getElementById('book-count').textContent = dataStore.book.length;
    }
    document.addEventListener('DOMContentLoaded',()=>{
      // 顯示頁面載入進度條
      const loader = document.getElementById('page-loader');
      loader.style.display = 'block';
      // 動態產生多個小氣泡動畫
      document.querySelectorAll('.stat-card').forEach(card => {
        const bubbles = document.createElement('div');
        bubbles.className = 'bubbles';
        for(let i=0; i<7; i++) {
          const bubble = document.createElement('div');
          bubble.className = 'bubble';
          const size = Math.random() * 18 + 12;
          bubble.style.width = `${size}px`;
          bubble.style.height = `${size}px`;
          bubble.style.left = `${Math.random() * 90}%`;
          bubble.style.bottom = `${Math.random() * 30}%`;
          bubble.style.animationDuration = `${3+ Math.random()*4}s`;
          bubble.style.animationDelay = `${Math.random()*8}s`;
          bubbles.appendChild(bubble);
        }
        card.appendChild(bubbles);
      });
      // 滾動動畫觀察器
      const scrollObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.scroll-animate').forEach(el => {
        scrollObserver.observe(el);
      });
      // AJAX 載入所有資料
      Promise.all([
        fetchData('thesis').then(data=>{dataStore.thesis=data;}),
        fetchData('journal').then(data=>{dataStore.journal=data;}),
        fetchData('book').then(data=>{dataStore.book=data;})
      ]).then(()=>{
        setTimeout(()=>{loader.style.display='none';},2000);
        updateStats();
        switchTab('thesis', document.querySelector('.nav-link.active'));
        document.querySelectorAll('.filter').forEach(input=>{
          input.addEventListener('input',function(){
            if(document.getElementById('thesis').classList.contains('d-none')===false) filterData('thesis');
            if(document.getElementById('journal').classList.contains('d-none')===false) filterData('journal');
            if(document.getElementById('book').classList.contains('d-none')===false) filterData('book');
          });
        });
      });
    });
    function switchTab(id,btn){
      document.querySelectorAll('.nav-link').forEach(e=>e.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.tab-content').forEach(s=>s.classList.add('d-none'));
      document.getElementById(id).classList.remove('d-none');
      updateStats();
      render(id);
    }
    // 分頁功能
    const PAGE_SIZE = 30;
    function render(type, data) {
      const body = document.getElementById(`${type}-body`);
      const pagination = document.getElementById(`${type}-pagination`);
      const allData = data || dataStore[type];
      let page = Number(pagination?.getAttribute('data-page')) || 1;
      const total = allData.length;
      const totalPages = Math.ceil(total / PAGE_SIZE) || 1;
      if(page > totalPages) page = totalPages;
      const start = (page-1)*PAGE_SIZE;
      const end = start+PAGE_SIZE;
      const pageData = allData.slice(start, end);
      body.innerHTML = '';
      pageData.forEach((r, index) => {
        const tr = document.createElement('tr');
        Object.keys(r).forEach((key, colIndex) => {
          const td = document.createElement('td');
          if((type === 'thesis' && key === '論文名稱') || (type === 'book' && key === '書名')) td.className = 'book-title';
          td.textContent = r[key];
          tr.appendChild(td);
        });
        body.appendChild(tr);
      });
      // 分頁按鈕
      if(pagination) {
        pagination.innerHTML = '';
        pagination.setAttribute('data-page', page);
        const createBtn = (p, text, active=false, disabled=false) => {
          const li = document.createElement('li');
          li.className = `page-item${active? ' active':''}${disabled?' disabled':''}`;
          const a = document.createElement('a');
          a.className = 'page-link';
          a.href = '#';
          a.textContent = text;
          a.onclick = (e)=>{e.preventDefault();if(!disabled){pagination.setAttribute('data-page', p);render(type, allData);}};
          li.appendChild(a);
          return li;
        };
        pagination.appendChild(createBtn(1, '«', page===1, page===1));
        for(let i=1;i<=totalPages;i++) {
          if(i===1||i===totalPages||Math.abs(i-page)<=2) {
            pagination.appendChild(createBtn(i, i, page===i));
          } else if(i===page-3||i===page+3) {
            const li = document.createElement('li');li.className='page-item disabled';li.innerHTML='<span class="page-link">…</span>';pagination.appendChild(li);
          }
        }
        pagination.appendChild(createBtn(totalPages, '»', page===totalPages, page===totalPages));
      }
    }
    function renderBookCards(books) {
      const cardList = document.getElementById('book-card-list');
      cardList.innerHTML = '';
      if (books.length === 0) {
        cardList.style.display = 'none';
        document.getElementById('book-table-area').style.display = 'block';
        return;
      }
      books.forEach(book => {
        cardList.innerHTML += `
          <div class="col-12 col-md-6 col-lg-4">
            <div class="card p-3 mb-3">
              <h5 class="card-title">${book['書名'] || ''}</h5>
              <div>出版社：${book['出版者'] || ''}</div>
              <div>作者：${book['作者'] || ''}</div>
              <div>出版年：${book['出版年'] || ''}</div>
              <div>分類：${book['分類'] || ''}</div>
              <div>索書號：${book['索書號'] || ''}</div>
              <div>藏書位置：${book['藏書位置'] || ''}</div>
              <div>數量：${book['數量'] || ''}</div>
            </div>
          </div>
        `;
      });
      cardList.style.display = 'flex';
      document.getElementById('book-table-area').style.display = 'none';
    }
    function renderThesisCards(theses) {
      const cardList = document.getElementById('thesis-card-list');
      cardList.innerHTML = '';
      if (theses.length === 0) {
        cardList.style.display = 'none';
        document.getElementById('thesis-table-area').style.display = 'block';
        return;
      }
      theses.forEach(thesis => {
        cardList.innerHTML += `
          <div class="col-12 col-md-6 col-lg-4">
            <div class="card p-3 mb-3">
              <h5 class="card-title">${thesis['論文名稱'] || ''}</h5>
              <div>研究生：${thesis['研究生'] || ''}</div>
              <div>指導教授：${thesis['指導教授'] || ''}</div>
              <div>校院名稱：${thesis['校院名稱'] || ''}</div>
              <div>系所名稱：${thesis['系所名稱'] || ''}</div>
              <div>學位類別：${thesis['學位類別'] || ''}</div>
              <div>畢業學年度：${thesis['畢業學年度'] || ''}</div>
              <div>論文出版年：${thesis['論文出版年'] || ''}</div>
            </div>
          </div>
        `;
      });
      cardList.style.display = 'flex';
      document.getElementById('thesis-table-area').style.display = 'none';
    }
    function renderJournalCards(journals) {
      const cardList = document.getElementById('journal-card-list');
      cardList.innerHTML = '';
      if (journals.length === 0) {
        cardList.style.display = 'none';
        document.getElementById('journal-table-area').style.display = 'block';
        return;
      }
      journals.forEach(journal => {
        cardList.innerHTML += `
          <div class="col-12 col-md-6 col-lg-4">
            <div class="card p-3 mb-3">
              <h5 class="card-title">${journal['刊名'] || ''}</h5>
              <div>出版者：${journal['出版者'] || ''}</div>
              <div>作者：${journal['作者'] || ''}</div>
              <div>期數：${journal['期數'] || ''}</div>
              <div>期刊分類：${journal['期刊分類'] || ''}</div>
              <div>藏書位置：${journal['藏書位置'] || ''}</div>
            </div>
          </div>
        `;
      });
      cardList.style.display = 'flex';
      document.getElementById('journal-table-area').style.display = 'none';
    }
    function filterData(type) {
      const loader = document.getElementById('page-loader');
      loader.style.display = 'block';
      setTimeout(()=>{
        const filters = Array.from(document.querySelectorAll(`#${type} .filter`)).filter(input=>input.value.trim()!=='');
        let data = dataStore[type];
        if (filters.length > 0) {
          data = data.filter(row => {
            return filters.every(input => {
              const key = input.dataset.key;
              const value = input.value.trim().toLowerCase();
              if (!row[key]) return false;
              return row[key].toString().toLowerCase().includes(value);
            });
          });
        }
        if(type === 'book' && filters.length > 0 && data.length > 0) {
          renderBookCards(data);
        } else if(type === 'thesis' && filters.length > 0 && data.length > 0) {
          renderThesisCards(data);
        } else if(type === 'journal' && filters.length > 0 && data.length > 0) {
          renderJournalCards(data);
        } else {
          if(type === 'book') {
            document.getElementById('book-card-list').style.display = 'none';
            document.getElementById('book-table-area').style.display = 'block';
          }
          if(type === 'thesis') {
            document.getElementById('thesis-card-list').style.display = 'none';
            document.getElementById('thesis-table-area').style.display = 'block';
          }
          if(type === 'journal') {
            document.getElementById('journal-card-list').style.display = 'none';
            document.getElementById('journal-table-area').style.display = 'block';
          }
          render(type, data);
        }
        loader.style.display = 'none';
      }, 300);
    }
  </script>
</body>
</html>
